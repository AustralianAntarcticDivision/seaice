<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Build Temporary Virtual Raster Files for Sea Ice Concentration ‚Ä¢ seaice</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Build Temporary Virtual Raster Files for Sea Ice Concentration">
<meta property="og:description" content="Virtual raster files for available dates from online sources of sea ice concentration. These
 are used via GDAL to generate a grid of ice concentrations anywhere on Earth.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">seaice</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9080</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="seaice" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#seaice" class="anchor"></a>seaice</h1></div>
<!-- badges: start -->

<p>The goal of seaice is to read sea ice concentration data directly from the internet. This package contains functions to find the right file URL for a given date, for either northern or southern hemisphere data.</p>
<p>NOTE: you don‚Äôt need to use the functions in this package, see the example below which obtains a wrapper function <code>read_seaice()</code>. This package must exist to provide the tools for that to work, but for various reasons I don‚Äôt want the read function to be in this package.</p>
<div id="work-in-progress" class="section level2">
<h2 class="hasAnchor">
<a href="#work-in-progress" class="anchor"></a>Work in progress</h2>
<p>If you aren‚Äôt comfortable installing the development version of <a href="https://github.com/hypertidy/vapour.git">vapour</a> (instructions are given by the example function), the please don‚Äôt actually try to run the example. You can explore the sources and temporary files created by the functions in this package, they are</p>
<ul>
<li><code>nsidc_north_files</code></li>
<li><code>nsidc_north_ftp</code></li>
<li><code>nsidc_north_vrt</code></li>
<li><code>nsidc_north_vrt_text</code></li>
<li><code>nsidc_south_files</code></li>
<li><code>nsidc_south_ftp</code></li>
<li><code>nsidc_south_vrt</code></li>
<li><code>nsidc_south_vrt_text</code></li>
</ul>
<p>The <code>*files()</code> functions return a data frame of dates and URLs. The <code>*_ftp()</code> functions return the actual URL for a given date (a binary file). The <code>*_vrt()</code> functions return the path to a temporary VRT file that wraps the source URL for a given date with a <a href="https://gdal.org/drivers/raster/vrt.html">GDAL VRT</a> virtual raster. The <code>*_vrt_text()</code> functions return the contents of the VRT file for a given date.</p>
<p>The <code>read_seaice()</code> function defined below relies on dev-vapour package and wraps up the above to drive GDAL to return the data for a given data on your raster grid of choice.</p>
<p>This package contains a file list (where the file is on the internet, and the date it applies to) for a data file, and will construct a raster format that can be used to read the data directly. This happens via GDAL, using its virtual raster format ‚ÄúVRT‚Äù. A temporary file is created to store the information about the file at the URL, and then GDAL does the rest, downloading the file and reading from it into whatever grid/projection we specify.</p>
<p>With this we can</p>
<ul>
<li>read any date since 1978-10-26 (currently we are a bit limited to the latest but see todo)</li>
<li>specify a raster grid, of any resolution, any projection, and any extent any where on the planet (the polar regions are really the only relevant ones, but we can use the entire earth or part of it)</li>
<li>read both hemispheres in one call</li>
</ul>
<p>If you prefer stars or terra or raster or some other package, throw the VRT file path at their raster read functions. üëç</p>
</div>
<div id="todo" class="section level2">
<h2 class="hasAnchor">
<a href="#todo" class="anchor"></a>TODO</h2>
<ul>
<li>currently only NSIDC, add more providers</li>
<li>keep files up to date, started with 2021-05-23</li>
<li>be smarter about filling in missing days</li>
<li>write helpers for commonly used grids (e.g.¬†0.25 degree longlat, Mercator, or local equal area, etc)</li>
<li>write helpers for terra, stars, base image(), netcdf output, whatever</li>
<li>speed it up, currently a bit slow (25s for each file, but subsequent read of each day is fast because the file seems to be cached by GDAL or the OS)</li>
</ul>
<p>These files are binary and read over FTP, so the entire file is downloaded somewhere by GDAL (they are small). Other sources use GeoTIFF or NetCDF and we are exploring including those as well.</p>
<p>Let us know what you think! See the <a href="https://github.com/AustralianAntarcticDivision/seaice/issues">Issues tab</a> to discuss, or post information about any problems you encounter.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"AustralianAntarcticDivision/seaice"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example which shows you how to read sea ice data for any date since 1978-10-26. The data is projected onto a raster grid, with a global default provided. You can use the <code>xylim</code> argument to specify a specific raster in any projection.</p>
<p>Go with the default.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">seaice</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"examples/read_seaice.R"</span>, package <span class="op">=</span> <span class="st">"seaice"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>  <span class="co"># we could use terra or stars or whatever, see todo </span>
<span class="co">#&gt; Loading required package: sp</span>

<span class="va">icecol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html">grey.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">zl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">ice0</span> <span class="op">&lt;-</span> <span class="fu">read_seaice</span><span class="op">(</span><span class="st">"2020-10-15"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">ice0</span>, col <span class="op">=</span> <span class="va">icecol</span>, zlim <span class="op">=</span> <span class="va">zl</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-default-1.png" width="100%"></p>
<p>Usually we will want something more specific, like only the southern hemisphere. To do that, define the right raster grid and set the <code>xylim</code> argument with it.</p>
<p>The source data for this function is 25km pixels, in a polar grid. We choose 0.2 in degrees as the resolution (about a fifth of 100km which is about the distance in a degree along a great circle).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span>, <span class="op">-</span><span class="fl">76</span>, <span class="op">-</span><span class="fl">55</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">0.2</span>, crs <span class="op">=</span> <span class="st">"+proj=longlat"</span><span class="op">)</span>
<span class="op">(</span><span class="va">ice</span> <span class="op">&lt;-</span> <span class="fu">read_seaice</span><span class="op">(</span><span class="st">"2020-10-15"</span>, xylim <span class="op">=</span> <span class="va">r</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; class      : RasterLayer </span>
<span class="co">#&gt; dimensions : 105, 1800, 189000  (nrow, ncol, ncell)</span>
<span class="co">#&gt; resolution : 0.2, 0.2  (x, y)</span>
<span class="co">#&gt; extent     : -180, 180, -76, -55  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=longlat +datum=WGS84 +no_defs </span>
<span class="co">#&gt; source     : memory</span>
<span class="co">#&gt; names      : layer </span>
<span class="co">#&gt; values     : 1.2, 100  (min, max)</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">ice</span>, col <span class="op">=</span> <span class="va">icecol</span>, zlim <span class="op">=</span> <span class="va">zl</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-custom-1.png" width="100%"></p>
<p>Or we can pick our own projection/grid that we want.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2e6</span>, <span class="fl">2e6</span>, <span class="op">-</span><span class="fl">1e6</span>, <span class="fl">1e6</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">25000</span>, crs <span class="op">=</span> <span class="st">"+proj=laea +lat_0=-60 +lon_0=180"</span><span class="op">)</span>
<span class="va">pice</span> <span class="op">&lt;-</span> <span class="fu">read_seaice</span><span class="op">(</span><span class="st">"2020-10-15"</span>, xylim <span class="op">=</span> <span class="va">rg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">pice</span>, col <span class="op">=</span> <span class="va">icecol</span>, zlim <span class="op">=</span> <span class="va">zl</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co">## hack a graticule</span>
<span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu">rgdal</span><span class="fu">::</span><span class="fu">project</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/xyFromCell.html">coordinates</a></span><span class="op">(</span><span class="va">rg</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html">projection</a></span><span class="op">(</span><span class="va">rg</span><span class="op">)</span>, inv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">ll</span><span class="op">[</span><span class="va">ll</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ll</span><span class="op">[</span><span class="va">ll</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">360</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/contour.html">contour</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/setValues.html">setValues</a></span><span class="op">(</span><span class="va">rg</span>, <span class="va">ll</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/contour.html">contour</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/setValues.html">setValues</a></span><span class="op">(</span><span class="va">rg</span>, <span class="va">ll</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-projection-1.png" width="100%"></p>
<p>To get exactly the grid used by this source data, use a bit of a trick.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nsidc_south_vrt.html">nsidc_south_vrt</a></span><span class="op">(</span><span class="op">)</span> <span class="co">## date does not matter, we just want the native grid specification so get the VRT</span>
<span class="co">## this is the grid, used by NSIDC, here in the abstract (no data in it)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="va">tfile</span><span class="op">)</span><span class="op">)</span>

<span class="va">native</span> <span class="op">&lt;-</span> <span class="fu">read_seaice</span><span class="op">(</span><span class="st">"2020-10-15"</span>, xylim <span class="op">=</span> <span class="va">g</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">native</span>, col <span class="op">=</span> <span class="va">icecol</span>, zlim <span class="op">=</span> <span class="va">zl</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-native-1.png" width="100%"></p>
<p>This grid is an old one, defined as ‚ÄòEPSG:3412‚Äô. The north is ‚ÄòEPSG:3411‚Äô and that can be obtained the same, just replace ‚Äòsouth‚Äô with ‚Äònorth‚Äô in the code above.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">native</span><span class="op">)</span>
<span class="co">#&gt; class      : RasterLayer </span>
<span class="co">#&gt; dimensions : 332, 316, 104912  (nrow, ncol, ncell)</span>
<span class="co">#&gt; resolution : 25000, 25000  (x, y)</span>
<span class="co">#&gt; extent     : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs </span>
<span class="co">#&gt; source     : memory</span>
<span class="co">#&gt; names      : layer </span>
<span class="co">#&gt; values     : 1.2, 100  (min, max)</span></code></pre></div>
</div>
</div>
<div id="get-involved" class="section level1">
<h1 class="hasAnchor">
<a href="#get-involved" class="anchor"></a>Get involved</h1>
<p>Let us know what you think! See the <a href="https://github.com/AustralianAntarcticDivision/seaice/issues">Issues tab</a> to discuss, or post information about any problems you encounter.</p>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the seaice project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Michael Sumner <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/AustralianAntarcticDivision/seaice/actions"><img src="https://github.com/AustralianAntarcticDivision/seaice/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Michael Sumner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
